<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Formulario de cifrado</title>
</head>
<body>
  <form id="formulario" method="POST">
    <label for="mensaje">Mensaje:</label>
    <input type="text" id="mensaje" name="mensaje">
    <label for="clave">Clave:</label>
    <input type="password" id="clave" name="clave">
    <button type="submit">Cifrar</button>
  </form>

  <div id="resultado"></div>

  <!--En otra seccion del sitio que pida el mensaje incriptado y la clave para desincriptar-->
  <form id="formularioDes" method="POST">
    <label for="mensajeDes">Mensaje cifrado:</label>
    <input type="text" id="mensajeDes" name="mensajeDes">
    <label for="claveDes">Clave:</label>
    <input type="password" id="claveDes" name="claveDes">
    <button type="submit">Descifrar</button>
  </form>

  <div id="resultadoDes"></div>

  <script>
    const formulario = document.getElementById('formulario');
    const mensaje = document.getElementById('mensaje');
    const clave = document.getElementById('clave');
    const resultado = document.getElementById('resultado');

    formulario.addEventListener('submit', async (event) => {
      event.preventDefault();

      const data = {
        mensaje: mensaje.value,
        clave: clave.value.toString()
      };

      await fetch('/.netlify/functions/cifrado-xor', {
        method: 'POST',
        body: JSON.stringify(data)
      })
        .then(response => response.text())
        .then(mensajeCifrado => {
          resultado.textContent = `Mensaje cifrado: ${mensajeCifrado}`;
        })
        .catch(error => {
          resultado.textContent = `Error: ${error}`;
        });
    });

    const formularioDes = document.getElementById('formularioDes');
    const mensajeDes = document.getElementById('mensajeDes');
    const claveDes = document.getElementById('claveDes');
    const resultadoDes = document.getElementById('resultadoDes');

    formularioDes.addEventListener('submit', async (event) => {
      event.preventDefault();

      const data = {
        mensaje: mensajeDes.value,
        clave: claveDes.value.toString()
      };

      await fetch('/.netlify/functions/descifrado-xor', {
        method: 'POST',
        body: JSON.stringify(data)
      })
        .then(response => response.text())
        .then(mensajeDescifrado => {
          resultadoDes.textContent = `Mensaje descifrado: ${mensajeDescifrado}`;
        })
        .catch(error => {
          resultadoDes.textContent = `Error: ${error}`;
        });
    });
  </script>
</body>
</html>