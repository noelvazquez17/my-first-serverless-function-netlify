<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Formulario de cifrado</title>
  <link rel="stylesheet" href="./css/styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;400;500&display=swap" rel="stylesheet">
</head>

<body>
  <header>
    <h1 class="c-2">Cifrado XOR</h1>
    <p class="par">Segundo proyecto de la materia Servicios Cloud. <br>
      El propósito es recibir un mensaje en texto y encriptarlo mediante algún método simétrico.<br>
      Regresar el mensaje encriptado adecuadamente.<br>
      El cliente puede comprobar desencriptando el mensaje conociendo la clave<br>
      de encriptamiento por medio de un programa en el cliente.<br>
    </p>
  </header>
  
<div class="container">
  <h2 class="c-2">Cifrado</h2>
  <div class=" center space">
    <section>
      <form id="formulario" method="POST">
        <section class="space distribucion">
          <p>Mensaje</p>
          <textarea type="text" name="mensaje" id="mensaje" cols="55" rows="10" placeholder="Ingresar mensaje"></textarea>
        </section>
        <div class="clav">
          <label for="clave">Clave:</label>
          <input type="password" id="clave" name="clave">
          <button type="submit" class="btn">Cifrar</button>
        </div>
      </form>
    </section>
    <section class="space distribucion">
      <p>Mensaje cifrado</p>
      <textarea name="" id="resultado" cols="55" rows="10" placeholder="Mensaje cifrado."></textarea>
    </section>
  </div>
</div>
  
<div class="container clav">
  <h2 class="c-2"> Descifrado</h2>
  <!--En otra seccion del sitio que pida el mensaje incriptado y la clave para desincriptar-->
  <div class=" center space dw">
    <section>
      <form id="formularioDes" method="POST">
        <section class="space distribucion">
          <p>Mensaje cifrado</p>
          <textarea type="text" name="mensajeDes" id="mensajeDes" cols="55" rows="10" placeholder="Ingresar mensaje cifrado"></textarea>
        </section>
        <div class="clav">
          <label for="claveDes">Clave:</label>
          <input type="password" id="claveDes" name="claveDes">
          <button type="submit" class="btn">Descifrar</button>
        </div>
      </form>
    </section>
    <section class="space distribucion">
      <p>Mensaje descifrado</p>
      <textarea name="" id="resultadoDes" cols="55" rows="10" placeholder="Mensaje descifrado."></textarea>
    </section>
  </div>
</div>
  

  <script>
    const formulario = document.getElementById('formulario');
    const mensaje = document.getElementById('mensaje');
    const clave = document.getElementById('clave');
    const resultado = document.getElementById('resultado');

    formulario.addEventListener('submit', async (event) => {
      event.preventDefault();

      const data = {
        mensaje: mensaje.value,
        clave: clave.value.toString()
      };

      await fetch('/.netlify/functions/cifrado-xor', {
        method: 'POST',
        body: JSON.stringify(data)
      })
        .then(response => response.text())
        .then(mensajeCifrado => {
          resultado.textContent = ` ${mensajeCifrado}`;
        })
        .catch(error => {
          resultado.textContent = `Error: ${error}`;
        });
    });

    const formularioDes = document.getElementById('formularioDes');
    const mensajeDes = document.getElementById('mensajeDes');
    const claveDes = document.getElementById('claveDes');
    const resultadoDes = document.getElementById('resultadoDes');

    formularioDes.addEventListener('submit', async (event) => {
      event.preventDefault();

      const data = {
        mensaje: mensajeDes.value,
        clave: claveDes.value.toString()
      };

      await fetch('/.netlify/functions/descifrado-xor', {
        method: 'POST',
        body: JSON.stringify(data)
      })
        .then(response => response.text())
        .then(mensajeDescifrado => {
          resultadoDes.textContent = ` ${mensajeDescifrado}`;
        })
        .catch(error => {
          resultadoDes.textContent = `Error: ${error}`;
        });
    });
  </script>

  <footer class="foot">
    
    <p class="name center clav">Ivan Aldair Castillo Gutierrez <span class="prof">Estudiante</span></p>
    <p class="name center">Noel Vazquez Trujillo <span class="prof">Estudiante</span></p>
    <p class="name center">Alan Daniel Hernandez Villalobos <span class="prof">Estudiante</span></p>
    
  </footer>
</body>

</html>